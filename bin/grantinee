#!/usr/bin/env ruby

require "bundler/setup"
require "grantinee"

# Or use bin/grantinee -c config/grantinee.yml to load configuration from a file
if (config_file_index = ARGV.index('-c'))
  require 'yaml'
  config_yaml = YAML.load(File.read(ARGV[config_file_index+1]))

  Grantinee.configure do |c|
    config_yaml.each do |key, value|
      if Grantinee::Configuration::SUPPORTED_ARGUMENTS.include?(key.to_s)
        c.send(:"#{key}=", value)
      else
        puts "Warning: Unsupported configuration argument '#{key}'"
      end
    end
  end
end

# Read the DSL commands
Grantinee::Dsl.eval(File.read('Grantinee'))
